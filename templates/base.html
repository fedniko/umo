<html lang="ru">
    <head>
        {% load staticfiles %}
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/dataTables.bootstrap4.min.css' %}" type="text/css">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>{% block title %}{% endblock %}</title>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
            <span class="navbar-brand mb-0 h1">Меню</span>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                {% if user.is_authenticated %}
                <ul class="navbar-nav text-uppercase g-font-weight-600 u-main-nav-v8 u-sub-menu-v3 mx-auto">
                    <li class="nav-item dropdown active">
                        <a class="nav-link dropdown-toggle" href="#" id="teacher" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Преподавателю
                        </a>
                        <div class="dropdown-menu" aria-labelledby="teacher">
                          <a class="dropdown-item" href="{% url 'disciplines:teacher' %}">Список дисциплин</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown active">
                        <a class="nav-link dropdown-toggle" href="#" id="admin" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Начальнику учебно-методического отдела
                        </a>
                        <div class="dropdown-menu" aria-labelledby="admin">
                          <a class="dropdown-item" href="{% url 'teachers:list_teachers' %}">Список преподавателей</a>
                          <a class="dropdown-item" href="{% url 'student_changelist' %}">Список студентов</a>
                          <a class="dropdown-item" href="{% url 'disciplines:disciplines_list' %}">Список дисциплин</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="{% url 'disciplines:excel' %}">Экран успеваемости</a>
                          <a class="dropdown-item" href="{% url 'nomenclatures:rup_list' %}">Рабочий учебный план</a>
                        </div>
                    </li>
                </ul>
                <ul class="navbar-nav navbar-right">
                    <li class="nav-item active">
                        <a class="nav-link" href="{% url 'logout' %}">Выйти</a>
                    </li>
                </ul>
                {% else %}
                <ul class="navbar-nav mr-auto">
                </ul>
                <ul class="navbar-nav navbar-right">
                    <li class="nav-item active">
                        <a class="nav-link" href="{% url 'login' %}">Вход</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="{% url 'register' %}">Регистрация</a>
                    </li>
                </ul>
                {% endif %}
            </div>
                </div>
        </nav>
        <div class="container">
            <br>
            {% block content %}
            {% endblock %}
        </div>
    </body>
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'js/dataTables.bootstrap4.min.js' %}"></script>
    <script>
        $(document).ready( function () {
            $('#my_table').DataTable( {
                "dom": 'rtipS',
                "info": false,
                "paging": false
            });
            var s = $('#students_list').DataTable({
                "columnDefs": [
                    {
                        "targets": [ 0 ],
                        "searchable": false,
                        "orderable": false
                    }
                ],
                "order": [[ 1, 'asc' ]],
                "dom": 'rtipS',
                "info": false,
                "paging": false,
                initComplete: function () {
                   var column = this.api().column(3);
                   var select = $('<select class="filter"><option value=""></option></select>')
                       .appendTo('#student_list_filter')
                       .on('change', function () {
                          var val = $(this).val();
                          column.search(val ? '^' + $(this).val() + '$' : val, true, false).draw();
                       });

                   column.data().unique().sort().each(function (d, j) {
                       select.append('<option value="' + d + '">' + d + '</option>');
                   });
                }
            });
            var t = $('#brs_list').DataTable({
                "columnDefs": [
                    {
                        "targets": [ 1 ],
                        "visible": false
                    },
                    {
                        "targets": [ 0 ],
                        "searchable": false,
                        "orderable": false
                    }
                ],
                "order": [[ 1, 'asc' ]],
                "dom": 'rtipS',
                "info": false,
                "paging": false,
                initComplete: function () {
                   var column = this.api().column(1);
                   var select = $('<select class="filter" name="selected_group"><option value="">-----------</option></select>')
                       .appendTo('#brs_list_filter')
                       .on('change', function () {
                          var val = $(this).val();
                          column.search(val ? '^' + $(this).val() + '$' : val, true, false).draw();
                       });

                   column.data().unique().sort().each(function (d, j) {
                       select.append('<option value="' + d + '">' + d + '</option>');
                   });
                }
            });
            s.on( 'order.dt search.dt', function () {
                s.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
                    cell.innerHTML = i+1;
                } );
            } ).draw();
            t.on( 'order.dt search.dt', function () {
                t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
                    cell.innerHTML = i+1;
                } );
            } ).draw();
        } );
    </script>
</html>